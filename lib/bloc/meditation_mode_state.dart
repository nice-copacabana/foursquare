// Generated by Qoder AI (Model: claude-sonnet-4-20250514) - 2025-11-24
// Task: 创建冥想模式状态定义

library;

import 'package:equatable/equatable.dart';
import '../models/board_state.dart';
import '../models/move.dart';
import '../models/piece_type.dart';

/// 冥想模式状态基类
sealed class MeditationModeState extends Equatable {
  const MeditationModeState();

  @override
  List<Object?> get props => [];
}

/// 初始状态
class MeditationInitial extends MeditationModeState {
  const MeditationInitial();
}

/// 语音引导中
class VoiceGuiding extends MeditationModeState {
  /// 引导文本
  final String guidanceText;
  
  /// 步骤编号
  final int stepNumber;

  const VoiceGuiding({
    required this.guidanceText,
    required this.stepNumber,
  });

  @override
  List<Object?> get props => [guidanceText, stepNumber];
}

/// 等待用户语音输入
class WaitingVoiceInput extends MeditationModeState {
  /// 当前玩家
  final PieceType currentPlayer;
  
  /// 当前棋盘
  final BoardState board;
  
  /// 已选中的棋子位置（如果有）
  final dynamic selectedPosition;
  
  /// 移动历史
  final List<Move> moveHistory;

  const WaitingVoiceInput({
    required this.currentPlayer,
    required this.board,
    this.selectedPosition,
    this.moveHistory = const [],
  });

  @override
  List<Object?> get props => [currentPlayer, board, selectedPosition, moveHistory];
}

/// 处理语音命令中
class ProcessingVoiceCommand extends MeditationModeState {
  /// 识别的文本
  final String recognizedText;
  
  /// 置信度
  final double confidence;
  
  /// 当前棋盘
  final BoardState board;
  
  /// 当前玩家
  final PieceType currentPlayer;

  const ProcessingVoiceCommand({
    required this.recognizedText,
    required this.confidence,
    required this.board,
    required this.currentPlayer,
  });

  @override
  List<Object?> get props => [recognizedText, confidence, board, currentPlayer];
}

/// 播报棋盘状态
class AnnouncingBoardState extends MeditationModeState {
  /// 当前棋盘
  final BoardState board;
  
  /// 播报队列
  final List<String> announcementQueue;
  
  /// 当前播报索引
  final int currentAnnouncementIndex;

  const AnnouncingBoardState({
    required this.board,
    required this.announcementQueue,
    this.currentAnnouncementIndex = 0,
  });

  @override
  List<Object?> get props => [board, announcementQueue, currentAnnouncementIndex];
}

/// 冥想对弈中
class MeditationPlaying extends MeditationModeState {
  /// 当前棋盘
  final BoardState board;
  
  /// 移动历史
  final List<Move> moveHistory;
  
  /// 当前玩家
  final PieceType currentPlayer;
  
  /// 是否AI对手
  final bool isAiOpponent;
  
  /// AI难度
  final int aiDifficulty;
  
  /// 最后播报的文本
  final String? lastAnnouncement;

  const MeditationPlaying({
    required this.board,
    required this.moveHistory,
    required this.currentPlayer,
    this.isAiOpponent = true,
    this.aiDifficulty = 2,
    this.lastAnnouncement,
  });

  @override
  List<Object?> get props => [
        board,
        moveHistory,
        currentPlayer,
        isAiOpponent,
        aiDifficulty,
        lastAnnouncement,
      ];

  /// 创建副本
  MeditationPlaying copyWith({
    BoardState? board,
    List<Move>? moveHistory,
    PieceType? currentPlayer,
    bool? isAiOpponent,
    int? aiDifficulty,
    String? lastAnnouncement,
  }) {
    return MeditationPlaying(
      board: board ?? this.board,
      moveHistory: moveHistory ?? this.moveHistory,
      currentPlayer: currentPlayer ?? this.currentPlayer,
      isAiOpponent: isAiOpponent ?? this.isAiOpponent,
      aiDifficulty: aiDifficulty ?? this.aiDifficulty,
      lastAnnouncement: lastAnnouncement ?? this.lastAnnouncement,
    );
  }
}

/// AI思考中
class AiThinking extends MeditationModeState {
  /// 当前棋盘
  final BoardState board;
  
  /// 移动历史
  final List<Move> moveHistory;
  
  /// AI难度
  final int aiDifficulty;

  const AiThinking({
    required this.board,
    required this.moveHistory,
    required this.aiDifficulty,
  });

  @override
  List<Object?> get props => [board, moveHistory, aiDifficulty];
}

/// 暂停状态
class MeditationPaused extends MeditationModeState {
  /// 暂停原因
  final String reason;
  
  /// 暂停前的棋盘
  final BoardState board;
  
  /// 暂停前的移动历史
  final List<Move> moveHistory;
  
  /// 暂停前的当前玩家
  final PieceType currentPlayer;

  const MeditationPaused({
    required this.reason,
    required this.board,
    required this.moveHistory,
    required this.currentPlayer,
  });

  @override
  List<Object?> get props => [reason, board, moveHistory, currentPlayer];
}

/// 游戏结束
class MeditationGameOver extends MeditationModeState {
  /// 胜者
  final PieceType? winner;
  
  /// 结束原因
  final String reason;
  
  /// 最终棋盘
  final BoardState finalBoard;
  
  /// 移动历史
  final List<Move> moveHistory;

  const MeditationGameOver({
    this.winner,
    required this.reason,
    required this.finalBoard,
    required this.moveHistory,
  });

  @override
  List<Object?> get props => [winner, reason, finalBoard, moveHistory];
}

/// 错误状态
class MeditationError extends MeditationModeState {
  /// 错误消息
  final String errorMessage;
  
  /// 错误类型
  final String errorType;
  
  /// 是否可恢复
  final bool recoverable;

  const MeditationError({
    required this.errorMessage,
    required this.errorType,
    this.recoverable = true,
  });

  @override
  List<Object?> get props => [errorMessage, errorType, recoverable];
}
