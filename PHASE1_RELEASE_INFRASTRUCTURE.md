# 阶段1：应用发布基础设施 - 实施文档

<!-- Generated by Qoder AI (Model: claude-sonnet-4-5-20250929) - 2025-10-22 -->
<!-- Task: 应用发布基础设施完整实施指南 -->

## 概述

本文档记录了四子游戏项目第四轮迭代阶段1的实施内容，包括应用图标、启动屏幕、元数据配置和应用商店资产准备。

## 任务清单

### ✅ 1.1 应用图标配置

**已完成**:
- [x] 创建图标资源目录 `assets/icon/`
- [x] 添加 `flutter_launcher_icons` 依赖 (v0.13.1)
- [x] 创建 `flutter_launcher_icons.yaml` 配置文件
- [x] 创建图标设计规范文档 `DESIGN_SPEC.md`
- [x] 创建图标目录说明文档 `README.md`
- [x] 更新 `pubspec.yaml` 包含图标资源

**待完成**:
- [ ] 创建应用图标设计（1024x1024 PNG）
- [ ] 创建Android自适应前景图（432x432 PNG）
- [ ] 运行 `flutter pub run flutter_launcher_icons` 生成各平台图标

**设计要求**:
- 主图标：`assets/icon/app_icon.png` (1024x1024)
- 自适应前景：`assets/icon/adaptive_foreground.png` (432x432)
- 配色：主色 #1976D2，黑子 #212121，白子 #FAFAFA
- 元素：4x4棋盘网格 + 黑白各4个棋子

### ✅ 1.2 启动屏幕配置

**已完成**:
- [x] 创建启动屏资源目录 `assets/splash/`
- [x] 添加 `flutter_native_splash` 依赖 (v2.3.10)
- [x] 创建 `flutter_native_splash.yaml` 配置文件
- [x] 创建启动屏目录说明文档 `README.md`
- [x] 更新 `pubspec.yaml` 包含启动屏资源

**待完成**:
- [ ] 创建启动屏Logo设计（512x512 PNG）
- [ ] （可选）创建深色模式Logo
- [ ] 运行 `flutter pub run flutter_native_splash:create` 生成启动屏

**设计要求**:
- Logo：`assets/splash/logo.png` (512x512)
- 深色Logo：`assets/splash/logo_dark.png` (512x512，可选)
- 背景色：#1976D2（浅色）/ #1565C0（深色）
- Logo：白色或浅色版本

### ⏳ 1.3 应用元数据配置

**待完成任务**:
- [ ] 配置Android元数据（AndroidManifest.xml）
- [ ] 配置iOS元数据（Info.plist）
- [ ] 配置Web元数据（manifest.json）
- [ ] 设置版本号为 1.0.0
- [ ] 配置应用权限声明

**Android配置要点**:
```xml
<!-- AndroidManifest.xml -->
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.qoder.foursquare">
    
    <application
        android:label="四子游戏"
        android:name="${applicationName}"
        android:icon="@mipmap/ic_launcher">
        <!-- ... -->
    </application>
    
    <!-- 权限 -->
    <uses-permission android:name="android.permission.INTERNET" />
    <uses-permission android:name="android.permission.VIBRATE" />
    <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
</manifest>
```

**iOS配置要点**:
```xml
<!-- Info.plist -->
<key>CFBundleDisplayName</key>
<string>四子游戏</string>
<key>CFBundleIdentifier</key>
<string>com.qoder.foursquare</string>
<key>CFBundleVersion</key>
<string>1</string>
<key>CFBundleShortVersionString</key>
<string>1.0.0</string>
```

**Web配置要点**:
```json
{
  "name": "四子游戏 - Four Square Chess",
  "short_name": "四子游戏",
  "description": "策略性四子棋游戏",
  "start_url": "/",
  "display": "standalone",
  "background_color": "#1976D2",
  "theme_color": "#1976D2"
}
```

### ⏳ 1.4 应用商店资产准备

**待完成任务**:
- [ ] 创建应用截图（6-8张）
- [ ] 创建Google Play宣传图（1024x500）
- [ ] 编写应用描述文案（中英文）
- [ ] 编写应用更新说明模板
- [ ] 准备隐私政策链接
- [ ] （可选）录制演示视频（15-30秒）

**截图内容规划**:
1. 主菜单 - 展示Logo和功能入口
2. 双人对战 - 展示棋盘和游戏进行中
3. 人机对战 - 展示AI难度选择和思考状态
4. 游戏回放 - 展示历史记录和步骤导航
5. 统计分析 - 展示图表和战绩数据
6. 多主题 - 展示不同主题皮肤
7. 在线对战 - 展示匹配界面（如已实现）
8. 设置界面 - 展示自定义选项

**应用描述文案（简短版，80字）**:
```
经典四子棋策略游戏，支持双人对战、智能AI挑战、在线匹配。
精美界面，流畅动画，多种主题皮肤。挑战你的策略思维！
```

**关键词标签**:
四子棋、策略游戏、棋类游戏、AI对战、在线对战、益智游戏、休闲游戏、双人游戏

## 配置文件说明

### flutter_launcher_icons.yaml

图标生成配置文件，定义了：
- Android/iOS/Web平台图标生成
- 自适应图标配置（Android）
- 透明通道处理（iOS）
- 源图片路径和背景色

### flutter_native_splash.yaml

启动屏配置文件，定义了：
- 浅色/深色模式背景色
- Logo图片路径
- Android 12+适配
- 各平台启动屏配置
- 全屏模式设置

## 生成步骤

### 步骤1：准备资源文件

```bash
# 创建或放置设计好的图标文件
assets/icon/app_icon.png              # 1024x1024
assets/icon/adaptive_foreground.png    # 432x432
assets/splash/logo.png                 # 512x512
assets/splash/logo_dark.png            # 512x512（可选）
```

### 步骤2：安装依赖

```bash
cd d:\Develop\outworks\foursquare
flutter pub get
```

### 步骤3：生成图标

```bash
# 生成所有平台的应用图标
flutter pub run flutter_launcher_icons
```

预期输出：
- Android: `android/app/src/main/res/mipmap-*/ic_launcher.png`
- iOS: `ios/Runner/Assets.xcassets/AppIcon.appiconset/*`
- Web: `web/icons/*`

### 步骤4：生成启动屏

```bash
# 生成所有平台的启动屏幕
flutter pub run flutter_native_splash:create
```

预期输出：
- Android: `android/app/src/main/res/drawable*/launch_background.xml`
- iOS: `ios/Runner/Assets.xcassets/LaunchImage.imageset/*`
- Web: `web/splash/*`

### 步骤5：验证生成结果

```bash
# 运行应用验证图标和启动屏
flutter run
```

检查项：
- [ ] 应用图标显示正确
- [ ] 启动屏幕显示正确
- [ ] 浅色/深色模式切换正常
- [ ] Android自适应图标正常（长按图标查看）
- [ ] 各平台图标清晰无失真

## 版本管理

### 版本号规范

采用语义化版本号（Semantic Versioning）：`MAJOR.MINOR.PATCH`

- **MAJOR**: 重大功能更新或不兼容变更
- **MINOR**: 新增功能或较大改进
- **PATCH**: Bug修复或小优化

**当前版本规划**:
- 开发版本：0.1.0（当前）
- 第一个正式版本：1.0.0（本轮迭代目标）
- 后续小版本：1.0.1, 1.0.2...
- 后续功能版本：1.1.0, 1.2.0...

### 构建号管理

- **Android**: `versionCode`（整数，每次构建递增）
- **iOS**: `Build Number`（整数，每次构建递增）

建议使用时间戳格式：`YYMMDDNN`
- 例如：`25102201` = 2025年10月22日第01次构建

## 临时方案（图标未设计时）

如果暂时无法提供专业设计的图标，可以采用以下临时方案：

### 方案1：使用文本Logo

使用在线工具（如Canva）生成简单文字Logo：
- 文字内容："四子" 或 "4x4"
- 背景色：#1976D2
- 字体：粗体、现代风格
- 导出为1024x1024 PNG

### 方案2：保留Flutter默认图标

暂时使用Flutter默认蓝色图标，后续版本更新：
- 不运行 `flutter_launcher_icons`
- 保持默认配置
- 在v1.1或v1.2版本更新正式设计

### 方案3：使用简化几何图形

使用绘图工具（如GIMP、Paint.NET）创建简单图标：
- 蓝色背景（#1976D2）
- 白色4x4网格线
- 简单的圆形代表棋子
- 导出为1024x1024 PNG

## 资源文件清单

### 已创建文档

- [x] `flutter_launcher_icons.yaml` - 图标生成配置
- [x] `flutter_native_splash.yaml` - 启动屏生成配置
- [x] `assets/icon/DESIGN_SPEC.md` - 图标和启动屏设计规范
- [x] `assets/icon/README.md` - 图标资源目录说明
- [x] `assets/splash/README.md` - 启动屏资源目录说明
- [x] `pubspec.yaml` - 已更新依赖和资源路径

### 待创建资源

- [ ] `assets/icon/app_icon.png` (1024x1024) - 主应用图标
- [ ] `assets/icon/adaptive_foreground.png` (432x432) - Android自适应前景
- [ ] `assets/splash/logo.png` (512x512) - 启动屏Logo
- [ ] `assets/splash/logo_dark.png` (512x512) - 深色模式Logo（可选）

## 常见问题

### Q1: 如何修改图标或启动屏？

1. 替换 `assets/icon/` 或 `assets/splash/` 中的图片文件
2. 重新运行生成命令：
   ```bash
   flutter pub run flutter_launcher_icons
   flutter pub run flutter_native_splash:create
   ```
3. 清理构建缓存并重新运行：
   ```bash
   flutter clean
   flutter run
   ```

### Q2: Android自适应图标不显示？

- 确保 `adaptive_foreground.png` 存在且尺寸正确（432x432）
- 检查 `flutter_launcher_icons.yaml` 中的 `adaptive_icon_foreground` 路径
- 在Android 8.0+设备上测试
- 长按应用图标查看自适应效果

### Q3: iOS图标包含Alpha通道错误？

- 确保 `flutter_launcher_icons.yaml` 中设置了 `remove_alpha_ios: true`
- 或者使用无透明通道的PNG图片（24位RGB）

### Q4: 启动屏在Android 12+设备上显示异常？

- 检查 `flutter_native_splash.yaml` 中的 `android_12` 配置
- 确保 `image` 路径正确
- Android 12+使用圆形图标，确保Logo在中心区域

### Q5: Web平台图标未更新？

- 清理浏览器缓存
- 检查 `web/manifest.json` 是否正确更新
- 检查 `web/icons/` 目录是否生成图标
- 重新部署Web应用

## 下一步行动

### 立即执行（P0）

1. **设计或准备图标资源**
   - 选择临时方案或委托设计
   - 准备4个PNG文件
   - 放置到对应目录

2. **生成并验证**
   - 运行生成命令
   - 在真机上测试
   - 检查各平台显示效果

3. **配置应用元数据**
   - 更新AndroidManifest.xml
   - 更新Info.plist
   - 更新manifest.json
   - 设置版本号为1.0.0

### 后续执行（P1）

4. **准备商店资产**
   - 录制或截取应用截图
   - 设计宣传图
   - 编写描述文案
   - 准备演示视频

5. **进入阶段2**
   - 生产环境优化
   - 性能和资源优化
   - 代码混淆配置

## 参考资源

### 官方文档
- [flutter_launcher_icons](https://pub.dev/packages/flutter_launcher_icons)
- [flutter_native_splash](https://pub.dev/packages/flutter_native_splash)
- [Android App Icons](https://developer.android.com/guide/practices/ui_guidelines/icon_design_adaptive)
- [iOS App Icons](https://developer.apple.com/design/human-interface-guidelines/ios/icons-and-images/app-icon/)

### 在线工具
- [App Icon Generator](https://www.appicon.co/) - 多平台图标生成
- [Canva](https://www.canva.com/) - 在线设计工具
- [Remove.bg](https://www.remove.bg/) - 背景移除
- [TinyPNG](https://tinypng.com/) - PNG压缩

### 设计参考
- [Material Design Icons](https://material.io/design/iconography)
- [Dribbble - App Icons](https://dribbble.com/search/app-icon)
- [Behance - Mobile App](https://www.behance.net/search/projects?search=mobile+app)

## 总结

阶段1的核心目标是建立应用发布的基础设施，包括视觉资产（图标和启动屏）、元数据配置和商店资产准备。

**当前进度**:
- ✅ 配置文件和文档已完成
- ⏳ 资源文件设计待完成
- ⏳ 元数据配置待完成
- ⏳ 商店资产待准备

**关键依赖**:
- 需要设计师提供专业图标设计，或使用临时方案
- 需要实际设备测试图标和启动屏效果
- 需要准备应用商店提交所需的所有资产

**下一阶段预告**:
阶段2将专注于生产环境优化，包括性能优化、资源优化、代码混淆和环境配置管理，为正式发布做好技术准备。
