# 四子游戏 (Four Square Game)

<!-- Generated by Qoder AI (Model: claude-sonnet-4-5-20250929) - 2025-10-22 -->

一款基于Flutter开发的跨平台策略棋类游戏。两名玩家在4x4棋盘上对弈，通过巧妙的移动和吃子，将对手的棋子减少到1个或更少即可获胜。

## 📋 项目状态

**当前版本**: 0.1.0 (开发中)  
**完成进度**: 约 17% (20/120 小时)  
**当前阶段**: Sprint 1.2 游戏规则引擎 ✅  
**下一阶段**: Sprint 1.3 UI基础组件

## 🎮 游戏规则

### 基本规则

1. **棋盘**: 4x4方格棋盘
2. **棋子**: 黑方4个棋子，白方4个棋子
3. **初始布局**:
   - 黑方棋子位于第一行: (0,0), (1,0), (2,0), (3,0)
   - 白方棋子位于第四行: (0,3), (1,3), (2,3), (3,3)
4. **回合**: 黑方先手，双方轮流移动

### 移动规则

- 每次只能移动一个己方棋子
- 只能移动到**四方向相邻**的空位（上、下、左、右）
- 不能斜向移动
- 不能越过其他棋子

### 吃子规则

移动后，如果在某个方向（横向或纵向）形成**"己-己-敌"**的连续三子，则吃掉敌方棋子。

**重要**: 移动的棋子必须参与这个三子连线。

#### 吃子示例

```
情况1：移动棋子在第一个位置
移动前: ○ 空 ○ ●
移动后: ○ ○ ○ ●  → 形成 ○○● → 吃掉 ●
       ^^^移动

情况2：移动棋子在第二个位置
移动前: ○ 空 ●
移动后: ○ ○ ●  → 形成 ○○● → 吃掉 ●
         ^移动
```

### 胜负判定

当某方棋子数量 ≤ 1 时，对方获胜。

## 🛠️ 技术栈

### 前端框架
- **Flutter** 3.0+ - 跨平台UI框架
- **Dart** 3.0+ - 编程语言

### 状态管理
- **flutter_bloc** 8.1.3 - BLoC状态管理
- **equatable** 2.0.5 - 值对象比较

### 本地存储
- **hive** 2.2.3 - NoSQL数据库
- **shared_preferences** 2.2.2 - 轻量配置存储

### 其他依赖
- **audioplayers** 5.2.1 - 音频播放
- **flutter_animate** 4.3.0 - 动画效果

### 开发工具
- **flutter_lints** 3.0.1 - 代码规范
- **mocktail** 1.0.1 - 单元测试Mock

## 📁 项目结构

```
lib/
├── models/              # 数据模型层 ✅
│   ├── position.dart
│   ├── piece_type.dart
│   ├── board_state.dart
│   ├── move.dart
│   └── game_result.dart
├── engine/              # 游戏引擎层 ✅
│   ├── move_validator.dart
│   ├── capture_detector.dart
│   └── game_engine.dart
├── ai/                  # AI算法（待开发）
├── state/               # 状态管理（待开发）
├── ui/                  # UI组件（待开发）
│   ├── screens/
│   ├── widgets/
│   └── animations/
├── services/            # 基础服务（待开发）
└── utils/               # 工具函数

test/                    # 测试文件
├── models/              # 8个测试文件
└── engine/              # 60+测试用例
```

## 🚀 快速开始

### 环境要求

- Flutter SDK >= 3.0.0
- Dart SDK >= 3.0.0

### 安装依赖

```bash
flutter pub get
```

### 运行应用

```bash
flutter run
```

### 运行测试

```bash
# 运行所有测试
flutter test

# 运行特定测试
flutter test test/models/position_test.dart

# 生成测试覆盖率报告
flutter test --coverage
```

### 代码检查

```bash
# Lint检查
flutter analyze

# 代码格式化
flutter format lib test
```

## 📖 开发文档

详细的技术设计和开发计划请参考：

- [项目立项文档](docs/项目立项文档.md)
- [技术架构与开发计划](docs/技术架构与开发计划.md)
- [四子游戏编码实施设计文档](docs/四子游戏编码实施设计文档.md)
- [实施计划跟踪](IMPLEMENTATION_PLAN.md)

## 🧪 测试说明

项目采用TDD（测试驱动开发）方式，核心逻辑100%测试覆盖。

### 测试统计

| 模块 | 测试文件 | 测试用例数 | 覆盖率 |
|------|----------|-----------|--------|
| Position | position_test.dart | 18 | 100% |
| PieceType | piece_type_test.dart | 6 | 100% |
| BoardState | board_state_test.dart | 25+ | 100% |
| Move | move_test.dart | 15+ | 100% |
| GameResult | game_result_test.dart | 15+ | 100% |
| MoveValidator | move_validator_test.dart | 18+ | 100% |
| CaptureDetector | capture_detector_test.dart | 20+ | 100% |
| GameEngine | game_engine_test.dart | 25+ | 95% |

## 🎯 开发里程碑

### Milestone 1: 核心游戏可玩 (Week 3)

**目标**: 完成基础游戏功能，支持双人本地对战

- [x] 数据模型层 ✅
- [x] 游戏规则引擎 ✅
- [ ] UI基础组件
- [ ] 游戏流程集成
- [ ] 动画效果
- [ ] 音效系统
- [ ] 主菜单和设置

### Milestone 2: AI对战完成 (Week 5)

**目标**: 实现三档难度的AI对手

- [ ] 基础规则AI（简单难度）
- [ ] Minimax算法AI（中等难度）
- [ ] Alpha-Beta剪枝AI（困难难度）
- [ ] AI难度选择界面

## 📄 许可证

本项目采用 MIT 许可证 - 详见 [LICENSE](LICENSE) 文件

## 👨‍💻 作者

**Four Square Game Team**

- 项目主导: 1人+AI全栈开发模式
- AI辅助: Qoder AI (Model: claude-sonnet-4-5-20250929)

---

**项目状态**: 🚧 开发中 | **最后更新**: 2025-10-22

[查看实施计划](IMPLEMENTATION_PLAN.md) | [查看设计文档](docs/)
