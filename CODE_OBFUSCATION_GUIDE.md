# 代码混淆与优化配置指南

<!-- Generated by Qoder AI (Model: claude-sonnet-4-5-20250929) - 2025-10-22 -->

## Android混淆配置

### ProGuard规则文件

已创建 `android/proguard-rules.pro` 文件，包含：
- Flutter框架保留规则
- Hive数据库保留规则
- 数据模型类保留规则
- WebSocket和AudioPlayers保留规则
- 日志移除规则
- 优化配置

### 启用混淆

在 `android/app/build.gradle` 中配置：

```gradle
android {
    buildTypes {
        release {
            minifyEnabled true
            shrinkResources true
            proguardFiles getDefaultProguardFile('proguard-android-optimize.txt'), 'proguard-rules.pro'
        }
    }
}
```

## iOS优化配置

在Xcode中配置：
1. Build Settings → Optimization Level → -Os (优化体积)
2. Build Settings → Strip Debug Symbols → Yes (Release)
3. Build Settings → Enable Bitcode → Yes
4. Build Settings → Generate Debug Symbols → Yes (生成dSYM用于崩溃分析)

## Dart代码混淆

### 构建命令

```bash
# Android APK混淆构建
flutter build apk --release --obfuscate --split-debug-info=build/app/outputs/symbols

# Android AAB混淆构建
flutter build appbundle --release --obfuscate --split-debug-info=build/app/outputs/symbols

# iOS混淆构建
flutter build ios --release --obfuscate --split-debug-info=build/ios/symbols

# Web构建（自动优化）
flutter build web --release --web-renderer canvaskit
```

### 混淆效果

- 类名、函数名变为无意义字符（如a、b、c）
- 减小包体积10-20%
- 增加反编译难度
- 保留调试符号用于崩溃分析

## 验证混淆效果

```bash
# 构建后检查APK大小
ls -lh build/app/outputs/flutter-apk/app-release.apk

# 使用APK Analyzer分析
# Android Studio → Build → Analyze APK
```

预期体积：<30MB（Android）、<40MB（iOS）
