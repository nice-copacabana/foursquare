# 四子游戏 - 快速开始指南

<!-- Generated by Qoder AI (Model: claude-sonnet-4-5-20250929) - 2025-10-22 -->
<!-- Task: 项目快速启动和发布准备指南 -->

## 项目概述

**项目名称**: 四子游戏 (Four Square Chess)  
**当前版本**: 0.1.0 (开发中)  
**目标版本**: 1.0.0 (生产就绪)  
**技术栈**: Flutter 3.0+, Dart 3.0+  

## 快速开始

### 1. 环境要求

- Flutter SDK >= 3.0.0
- Dart SDK >= 3.0.0
- Android Studio / VS Code
- Git

### 2. 克隆项目

```bash
git clone <repository-url>
cd foursquare
```

### 3. 安装依赖

```bash
flutter pub get
```

### 4. 运行项目

```bash
# 调试模式运行
flutter run

# 指定设备运行
flutter run -d chrome  # Web
flutter run -d <device-id>  # Android/iOS
```

### 5. 运行测试

```bash
# 运行所有测试
flutter test

# 运行特定测试文件
flutter test test/ai/minimax_ai_test.dart

# 生成测试覆盖率报告
flutter test --coverage
```

## 发布准备工作

### 阶段1：应用图标和启动屏（当前阶段）

#### 步骤1：创建图标资源

需要准备以下设计文件：

1. **主应用图标** - `assets/icon/app_icon.png` (1024x1024)
   - 4x4棋盘网格 + 黑白各4个棋子
   - 背景色：#1976D2
   - 无透明背景、无圆角

2. **Android自适应前景** - `assets/icon/adaptive_foreground.png` (432x432)
   - 仅包含棋子元素
   - 支持透明背景
   - 安全区域：中心288x288

3. **启动屏Logo** - `assets/splash/logo.png` (512x512)
   - 白色或浅色版本
   - 支持透明背景
   - 简化版应用图标

**设计参考**: 查看 `assets/icon/DESIGN_SPEC.md`

#### 步骤2：生成图标和启动屏

```bash
# 确保已安装依赖
flutter pub get

# 生成应用图标（所有平台）
flutter pub run flutter_launcher_icons

# 生成启动屏幕（所有平台）
flutter pub run flutter_native_splash:create
```

#### 步骤3：验证

```bash
# 清理缓存
flutter clean

# 重新运行
flutter run
```

检查：
- [ ] 应用图标显示正确
- [ ] 启动屏幕显示正确
- [ ] Android自适应图标效果（长按图标查看）

### 阶段2：应用元数据配置

#### Android配置

编辑 `android/app/build.gradle`:

```gradle
android {
    defaultConfig {
        applicationId "com.qoder.foursquare"
        minSdkVersion 21
        targetSdkVersion 34
        versionCode 1
        versionName "1.0.0"
    }
}
```

编辑 `android/app/src/main/AndroidManifest.xml`:

```xml
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.qoder.foursquare">
    
    <!-- 权限声明 -->
    <uses-permission android:name="android.permission.INTERNET" />
    <uses-permission android:name="android.permission.VIBRATE" />
    <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
    
    <application
        android:label="四子游戏"
        android:icon="@mipmap/ic_launcher">
        <!-- ... -->
    </application>
</manifest>
```

#### iOS配置

编辑 `ios/Runner/Info.plist`:

```xml
<key>CFBundleDisplayName</key>
<string>四子游戏</string>
<key>CFBundleIdentifier</key>
<string>com.qoder.foursquare</string>
<key>CFBundleVersion</key>
<string>1</string>
<key>CFBundleShortVersionString</key>
<string>1.0.0</string>
```

#### Web配置

编辑 `web/manifest.json`:

```json
{
  "name": "四子游戏 - Four Square Chess",
  "short_name": "四子游戏",
  "description": "策略性四子棋游戏",
  "start_url": "/",
  "display": "standalone",
  "background_color": "#1976D2",
  "theme_color": "#1976D2",
  "icons": [
    {
      "src": "icons/Icon-192.png",
      "sizes": "192x192",
      "type": "image/png"
    },
    {
      "src": "icons/Icon-512.png",
      "sizes": "512x512",
      "type": "image/png"
    }
  ]
}
```

### 阶段3：构建发布版本

#### Android APK构建

```bash
# 构建Release APK（带混淆）
flutter build apk --release --obfuscate --split-debug-info=build/app/outputs/symbols

# 构建App Bundle（Google Play推荐）
flutter build appbundle --release --obfuscate --split-debug-info=build/app/outputs/symbols
```

输出位置：
- APK: `build/app/outputs/flutter-apk/app-release.apk`
- AAB: `build/app/outputs/bundle/release/app-release.aab`

#### iOS IPA构建

```bash
# 构建iOS Release版本
flutter build ios --release

# 在Xcode中打开项目进行签名和导出
open ios/Runner.xcworkspace
```

#### Web构建

```bash
# 构建Web Release版本
flutter build web --release

# 使用CanvasKit渲染器（推荐）
flutter build web --release --web-renderer canvaskit
```

输出位置：`build/web/`

### 阶段4：测试

#### 单元测试

```bash
# 运行所有测试
flutter test

# 运行测试并生成覆盖率
flutter test --coverage

# 查看覆盖率报告（需要安装lcov）
genhtml coverage/lcov.info -o coverage/html
open coverage/html/index.html
```

#### 集成测试

```bash
# 运行集成测试
flutter test integration_test/
```

#### 性能测试

```bash
# 使用Flutter DevTools进行性能分析
flutter run --profile
# 然后打开 DevTools 进行分析
```

### 阶段5：发布到应用商店

#### Google Play

1. 创建Google Play开发者账号
2. 创建应用并填写商店信息
3. 准备资产：截图、宣传图、描述
4. 上传AAB文件
5. 提交审核

#### App Store

1. 创建Apple Developer账号
2. 在App Store Connect创建应用
3. 准备资产：截图、描述
4. 使用Xcode上传IPA
5. 提交审核

## 常用命令速查

```bash
# 依赖管理
flutter pub get              # 安装依赖
flutter pub upgrade          # 升级依赖
flutter pub outdated         # 查看可升级的包

# 代码分析
flutter analyze              # 代码静态分析
dart format lib/ test/       # 代码格式化

# 测试
flutter test                 # 运行所有测试
flutter test --coverage      # 生成覆盖率报告

# 构建
flutter build apk            # Android APK
flutter build appbundle      # Android AAB
flutter build ios            # iOS
flutter build web            # Web

# 清理
flutter clean                # 清理构建缓存
```

## 项目结构

```
foursquare/
├── android/               # Android平台代码
├── ios/                   # iOS平台代码
├── web/                   # Web平台代码
├── lib/                   # Dart源代码
│   ├── ai/               # AI系统
│   ├── bloc/             # 状态管理
│   ├── engine/           # 游戏引擎
│   ├── models/           # 数据模型
│   ├── services/         # 服务层
│   ├── ui/               # UI组件
│   │   ├── screens/     # 页面
│   │   └── widgets/     # 组件
│   ├── l10n/            # 国际化
│   └── main.dart        # 入口文件
├── test/                 # 测试文件
├── assets/              # 资源文件
│   ├── icon/           # 应用图标
│   ├── splash/         # 启动屏
│   ├── images/         # 图片
│   └── sounds/         # 音频
├── pubspec.yaml         # 依赖配置
├── flutter_launcher_icons.yaml   # 图标配置
├── flutter_native_splash.yaml    # 启动屏配置
└── README.md            # 项目说明
```

## 关键文档

- **设计规范**: `assets/icon/DESIGN_SPEC.md`
- **阶段1文档**: `PHASE1_RELEASE_INFRASTRUCTURE.md`
- **迭代总结**: `ITERATION_ROUND4_SUMMARY.md`
- **更新日志**: `CHANGELOG.md`
- **项目说明**: `README.md`

## 技术支持

### 已知问题

1. **GameBloc测试失败**（6个）
   - 原因：AudioPlayer初始化问题
   - 解决方案：使用Mock AudioService

2. **AI测试失败**（1个）
   - 原因：测试棋盘配置不准确
   - 解决方案：调整必胜局面

3. **Deprecated API警告**（78个）
   - 类型：Color.withOpacity()
   - 解决方案：迁移到Color.withValues()

### 资源链接

- [Flutter官方文档](https://docs.flutter.dev/)
- [Dart语言指南](https://dart.dev/guides)
- [Material Design](https://material.io/design)
- [flutter_launcher_icons](https://pub.dev/packages/flutter_launcher_icons)
- [flutter_native_splash](https://pub.dev/packages/flutter_native_splash)

## 版本历史

- **v0.1.0** (当前): 功能开发完成
- **v1.0.0** (计划): 生产发布版本

---

**最后更新**: 2025-10-22  
**维护者**: Qoder AI
