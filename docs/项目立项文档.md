# 四子游戏（FourSquare）项目立项文档

<!-- Generated by Qoder AI (Model: claude-sonnet-4-5-20250929) - 2025-10-21
     Task: 创建四子游戏项目立项文档 -->

## 文档版本
- **版本号**: v1.0
- **创建日期**: 2025-10-21
- **最后更新**: 2025-10-21
- **文档状态**: 初稿待审

---

## 1. 项目概述

### 1.1 项目背景

"四子游戏"是流行于中国鲁西南地区的一种传统民间棋类游戏，具有以下特点：
- **文化价值**: 承载地区民间智慧,具有文化传承意义
- **市场空白**: 网络上未见相关数字化产品，市场空白明显
- **易学难精**: 规则简单易懂，但策略深度足够，适合各年龄段玩家
- **快节奏**: 单局游戏时间较短，适合碎片化娱乐场景

### 1.2 项目目标

**核心目标**: 将"四子游戏"数字化，打造一款跨平台的成熟棋类游戏产品

**具体目标**:
1. 完整还原传统游戏规则和体验
2. 实现跨平台支持（Android、iOS、Web、小程序）
3. 提供单机、局域网、在线三种对战模式
4. 达到商业化产品标准，而非原型或Demo
5. 为后续功能扩展和商业化奠定基础

### 1.3 项目价值

**用户价值**:
- 传统游戏爱好者可以随时随地体验童年记忆
- 新玩家可以学习和传承地域文化
- 提供社交互动和竞技乐趣

**商业价值**:
- 填补市场空白，建立先发优势
- 平台化架构支持多元化变现模式
- 可扩展至其他民间棋类游戏系列

**文化价值**:
- 数字化保护和传承民间文化
- 促进地域文化传播

---

## 2. 游戏设计

### 2.1 游戏规则详述

#### 2.1.1 棋盘结构
```
棋盘布局（4×4网格，16个交叉点）:

0,0 ─── 0,1 ─── 0,2 ─── 0,3
 │       │       │       │
1,0 ─── 1,1 ─── 1,2 ─── 1,3
 │       │       │       │
2,0 ─── 2,1 ─── 2,2 ─── 2,3
 │       │       │       │
3,0 ─── 3,1 ─── 3,2 ─── 3,3
```

- 横竖各4条直线，形成16个交叉点
- 9个内部小正方形区域
- 所有棋子放置于交叉点上

#### 2.1.2 棋子配置
- **白方**: 4枚白色棋子（下方，位置 3,0 至 3,3）
- **黑方**: 4枚黑色棋子（上方，位置 0,0 至 0,3）
- **初始布局**: 基本模式固定布局，残局模式随机布局

#### 2.1.3 移动规则
- **行动顺序**: 双方轮流行动，每局轮流换先手
- **移动方式**: 沿线移动，仅上下左右四个方向，一次走一格
- **移动限制**: 不可跳跃，必须移动到相邻的空位
- **时间限制**: 每步限时1分钟，超时判负；总时长超1小时自动关闭棋局

#### 2.1.4 吃子规则（核心机制）

**触发条件**: 移动后满足以下条件即可吃掉对方棋子
1. **仅移动的棋子**参与吃子判定（其他棋子不会被动触发）
2. 形成 **己方-己方-对方** 三子紧邻直线（`○─○─●`）
3. 每次移动最多只能吃掉一枚对方棋子

**示例说明**:
```
场景1 - 正确吃子:
移动前: ○ ─  ● ─ 空
移动后: ○ ─  ○ ─ ●  (白方移动到中间，形成○─○─●)
结果: 吃掉黑方●

场景2 - 纵向吃子:
移动前: ○ │ ● │ 空
移动后: ○ │ ○ │ ●
结果: 吃掉黑方●

场景3 - 无法吃子（需三子紧邻）:
○ ─ 空 ─ ● ─ ○  (不是紧邻，无法吃子)

场景4 - 被动不触发:
移动前: ○ ─  ○ ─ ●─ ●
移动后: 空 ─  ○ ─ ●─ ● (第一个○移走)
结果: 虽然形成○─●─●，但移动的不是参与吃子的○，所以不触发
```

#### 2.1.5 胜负判定
- **失败条件**: 
  - 己方棋子被吃至仅剩1枚
  - 超时（每步超过1分钟）
- **胜利条件**: 对方失败
- **和棋情况**: 无和棋，必分胜负
- **自动关闭**: 总时长超过1小时自动关闭棋局

### 2.2 游戏流程

#### 2.2.1 游戏开始
1. 选择游戏模式（人机/局域网/在线）
2. 确定先手后手（随机或选择）
3. 棋子初始化摆放
4. 游戏开始

#### 2.2.2 回合流程
```
玩家回合开始
    ↓
选择要移动的棋子
    ↓
选择目标位置（高亮可移动位置）
    ↓
执行移动动画
    ↓
检测是否触发吃子
    ↓
（如触发）执行吃子动画
    ↓
检测胜负
    ↓
（未分胜负）切换到对方回合
```

#### 2.2.3 游戏结束
- 显示胜负结果
- 显示游戏统计（回合数、吃子数等）
- 提供选项：再来一局、返回主菜单、分享战绩

### 2.3 UI/UX设计方向

#### 2.3.1 视觉风格
- **主题**: 中国传统文化风格，融入现代简约设计
- **色彩**: 
  - 主色调：暖木色、墨黑、米白
  - 棋子：黑白双色（不使用红色）
- **材质**: 木质棋盘纹理、陶瓷/玉石棋子质感
- **动画**: 流畅自然，避免过度动效

#### 2.3.2 交互设计
- **棋子选择**: 点击选中，高亮可移动位置
- **移动操作**: 点击目标位置或拖拽棋子
- **反馈机制**: 
  - 音效：选中音、移动音、吃子音、胜负音
  - 震动：吃子时轻微震动
  - 视觉：移动轨迹、吃子特效

#### 2.3.3 功能页面
1. **启动页**: Logo展示、加载进度
2. **主菜单**: 模式选择、设置、排行榜、规则说明
3. **游戏页**: 棋盘、计时器、回合提示、悔棋/认输按钮
4. **结算页**: 胜负展示、数据统计、分享功能
5. **设置页**: 音效开关、震动开关、AI难度、主题切换

### 2.4 音效设计
- **背景音乐**: 轻松的中国风轻音乐（可关闭）
- **操作音效**: 
  - 棋子选中
  - 棋子移动
  - 吃子音效（重点设计）
  - 胜利/失败音效
- **音效要求**: 清脆、不刺耳、可独立开关

### 2.5 教学系统
- **新手引导**: 首次进入游戏时的交互式教程
- **规则说明**: 图文并茂的规则介绍页面
- **关卡挑战**: 设计特定局面让玩家练习吃子技巧

### 2.6 规则确认（已完成）✅

以下规则已与用户确认：

- ✅ **移动方向**: 仅四方向（上下左右），沿线一次一格，不可跳跃
- ✅ **初始布局**: 黑方0,0~0,3（上方），白方3,0~3,3（下方）
- ✅ **先手规则**: 每局轮流换先手
- ✅ **时间限制**: 每步1分钟，总时长1小时
- ✅ **吃子规则**: 每次最多吃一枚，需形成○─○─●三子紧邻
- ✅ **悔棋规则**: 后期考虑，需消耗道具
- ✅ **和棋规则**: 无和棋，必分胜负
- ✅ **棋子颜色**: 黑白双色，不使用红色

---

## 3. 技术方案

### 3.1 技术栈选型

#### 3.1.1 前端框架对比

| 技术栈 | 优势 | 劣势 | 综合评分 |
|--------|------|------|----------|
| **Flutter** | ✅ 原生性能<br>✅ 流畅动画<br>✅ 热重载快<br>✅ 跨平台统一<br>✅ 成熟生态 | ⚠️ 小程序需容器<br>⚠️ 包体积较大 | ⭐⭐⭐⭐⭐ |
| **Uni-app** | ✅ 小程序支持好<br>✅ 开发效率高<br>✅ 上手快 | ❌ 性能一般<br>❌ 动画体验差<br>❌ 复杂UI限制多 | ⭐⭐⭐ |
| **React Native** | ✅ 社区活跃<br>✅ 生态丰富<br>✅ 原生性能 | ❌ 小程序支持弱<br>❌ 配置复杂<br>❌ 版本兼容性问题 | ⭐⭐⭐⭐ |

**最终选择**: **Flutter**

**决策理由**:
1. 棋类游戏对动画流畅度要求高，Flutter表现最佳
2. 单一代码库维护成本低
3. Dart语言适合游戏逻辑编写
4. 小程序可通过FinClip等容器方案支持
5. 成熟的游戏开发插件（Flame引擎可选）

#### 3.1.2 后端技术栈

**推荐方案**: **Node.js + Socket.IO + Redis + MongoDB**

| 组件 | 技术选型 | 用途 |
|------|----------|------|
| 运行时 | Node.js | 服务端逻辑 |
| Web框架 | Express/Koa | RESTful API |
| 实时通信 | Socket.IO | 在线对战实时通信 |
| 缓存 | Redis | Session、匹配队列、排行榜 |
| 数据库 | MongoDB | 用户数据、对战记录 |
| 部署 | Docker + K8s | 容器化部署 |

**备选方案**: **Go + WebSocket**（更高性能需求时）
